import React, { useState, useEffect } from "react";

/* =========================
   ê³µí†µ: ë ˆë²¨ / ë³´ìƒ ì‹œìŠ¤í…œ í›…
   ========================= */
function useRewardSystem() {
  const [xp, setXp] = useState(0);
  const [level, setLevel] = useState(1);

  const addXp = (amount) => {
    setXp((prev) => prev + amount);
  };

  useEffect(() => {
    // 100XPë§ˆë‹¤ ë ˆë²¨ì—…
    const newLevel = Math.floor(xp / 100) + 1;
    setLevel(newLevel);
  }, [xp]);

  return { xp, level, addXp };
}

/* =========================
   1-1. ì˜¤ëŠ˜ì˜ ì‘ì€ ëª©í‘œ (Micro Goals)
   ========================= */
function MicroGoalsSection({ addXp }) {
  const baseGoals = [
    "ë¬¼ í•œ ì»µ ë§ˆì‹œê¸°",
    "ì˜¤ëŠ˜ ê³µë¶€ 20ë¶„ë§Œ í•´ë³´ê¸°",
    "ë°© ì •ë¦¬ 5ë¶„ë§Œ í•˜ê¸°",
    "ë°–ì— ë‚˜ê°€ì„œ 5ë¶„ ì‚°ì±…í•˜ê¸°",
    "ì˜¤ëŠ˜ í•´ì•¼ í•  ì¼ 3ê°œ ì ì–´ë³´ê¸°",
    "íœ´ëŒ€í° ë‚´ë ¤ë†“ê³  10ë¶„ ì§‘ì¤‘í•˜ê¸°",
  ];

  const [goals, setGoals] = useState(() =>
    baseGoals.slice(0, 3).map((text, idx) => ({
      id: idx + 1,
      text,
      done: false,
    }))
  );

  const handleToggle = (id) => {
    setGoals((prev) =>
      prev.map((g) => {
        if (g.id === id) {
          const newDone = !g.done;
          // ì²˜ìŒ ì™„ë£Œ ìƒíƒœë¡œ ë°”ë€” ë•Œ XP ì§€ê¸‰
          if (!g.done && newDone) {
            addXp(15); // ì‘ì€ ëª©í‘œ 1ê°œ = 15XP
          }
          return { ...g, done: newDone };
        }
        return g;
      })
    );
  };

  const handleShuffle = () => {
    const shuffled = [...baseGoals].sort(() => Math.random() - 0.5);
    setGoals(
      shuffled.slice(0, 3).map((text, idx) => ({
        id: idx + 1,
        text,
        done: false,
      }))
    );
  };

  const completedCount = goals.filter((g) => g.done).length;

  return (
    <div className="card">
      <h2> ì˜¤ëŠ˜ì˜ ì‘ì€ ëª©í‘œ</h2>
      <p className="sub">
        ê±°ì°½í•œ ê³„íš ë§ê³ , ì§€ê¸ˆ ë‹¹ì¥ í•  ìˆ˜ ìˆëŠ” ì•„ì£¼ ì‘ì€ í–‰ë™ë¶€í„° ì‹œì‘í•´ë³´ëŠ” ì˜ì—­ì…ë‹ˆë‹¤.
      </p>
      <ul className="goal-list">
        {goals.map((goal) => (
          <li key={goal.id} className="goal-item">
            <label>
              <input
                type="checkbox"
                checked={goal.done}
                onChange={() => handleToggle(goal.id)}
              />
              <span className={goal.done ? "goal-done" : ""}>{goal.text}</span>
            </label>
          </li>
        ))}
      </ul>
      <div className="goal-footer">
        <span>
          ì™„ë£Œí•œ ëª©í‘œ: {completedCount} / {goals.length}
        </span>
        <button onClick={handleShuffle}>ëª©í‘œ ë‹¤ì‹œ ì„ê¸°</button>
      </div>
    </div>
  );
}

/* =========================
   1-2. í™œë™ ê¸°ë¡ (ì€ë‘”Â·ì‰¬ì—ˆìŒ ì„¸ëŒ€ ê°ì†Œìš©)
   ========================= */
function ActivityTrackerSection({ addXp }) {
  const [activities, setActivities] = useState([
    { id: "study", label: "ê³µë¶€í•˜ê¸°", count: 0 },
    { id: "walk", label: "ì‚°ì±…/ì™¸ì¶œí•˜ê¸°", count: 0 },
    { id: "talk", label: "ì‚¬ëŒê³¼ ëŒ€í™” ë‚˜ëˆ„ê¸°", count: 0 },
    { id: "stretch", label: "ìŠ¤íŠ¸ë ˆì¹­/ê°„ë‹¨ ìš´ë™", count: 0 },
    { id: "selfcare", label: "ìê¸°ê´€ë¦¬(ìƒ¤ì›Œ, ì •ë¦¬ ë“±)", count: 0 },
  ]);

  const handleClick = (id) => {
    setActivities((prev) =>
      prev.map((a) =>
        a.id === id ? { ...a, count: a.count + 1 } : a
      )
    );
    addXp(10); // ì‘ì€ í™œë™ 1íšŒ = 10XP
  };

  const maxCount = Math.max(...activities.map((a) => a.count), 1);

  return (
    <div className="card">
      <h2> ì˜¤ëŠ˜ì˜ í™œë™ ê¸°ë¡</h2>
      <p className="sub">
        â€œì•„ë¬´ê²ƒë„ ì•ˆ í•œ ê²ƒ ê°™ì•„â€¦â€ë¼ëŠ” ê¸°ë¶„ì„ ì¤„ì´ê¸° ìœ„í•´,  
        ì•„ì£¼ ì‘ì€ í–‰ë™ì´ë¼ë„ ê¸°ë¡í•´ì„œ ëˆˆì— ë³´ì´ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ì˜ì—­ì…ë‹ˆë‹¤.
      </p>

      <div className="activity-buttons">
        {activities.map((a) => (
          <button key={a.id} onClick={() => handleClick(a.id)}>
            {a.label} +1
          </button>
        ))}
      </div>

      <div className="activity-chart">
        {activities.map((a) => (
          <div key={a.id} className="activity-row">
            <div className="activity-label">
              {a.label} ({a.count})
            </div>
            <div className="activity-bar-bg">
              <div
                className="activity-bar-fill"
                style={{
                  width: `${(a.count / maxCount) * 100}%`,
                }}
              />
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

/* =========================
   2-1. ë½€ëª¨ë„ë¡œ íƒ€ì´ë¨¸
   ========================= */
function PomodoroTimer({ onComplete }) {
  const [minutes, setMinutes] = useState(25);
  const [secondsLeft, setSecondsLeft] = useState(25 * 60);
  const [isRunning, setIsRunning] = useState(false);

  useEffect(() => {
    setSecondsLeft(minutes * 60);
  }, [minutes]);

  useEffect(() => {
    if (!isRunning) return;

    const timer = setInterval(() => {
      setSecondsLeft((prev) => {
        if (prev <= 1) {
          clearInterval(timer);
          setIsRunning(false);
          onComplete();
          return 0;
        }
        return prev - 1;
      });
    }, 1000);

    return () => clearInterval(timer);
  }, [isRunning, onComplete]);

  const formatTime = (totalSeconds) => {
    const m = Math.floor(totalSeconds / 60);
    const s = totalSeconds % 60;
    return `${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;
  };

  const handleStart = () => {
    if (secondsLeft > 0) setIsRunning(true);
  };

  const handlePause = () => {
    setIsRunning(false);
  };

  const handleReset = () => {
    setIsRunning(false);
    setSecondsLeft(minutes * 60);
  };

  return (
    <div className="card">
      <h2>â± ë½€ëª¨ë„ë¡œ ê³µë¶€ íƒ€ì´ë¨¸</h2>
      <p className="sub">
        25ë¶„ ì§‘ì¤‘ + 5ë¶„ íœ´ì‹ì²˜ëŸ¼, ì§§ì€ ì§‘ì¤‘ì„ ë°˜ë³µí•´ì„œ ê³µë¶€ ì˜ì§€ë¥¼ ìœ ì§€í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.
      </p>

      <label>
        íƒ€ì´ë¨¸ (ë¶„):
        <input
          type="number"
          min={1}
          max={120}
          value={minutes}
          onChange={(e) => setMinutes(Number(e.target.value) || 1)}
        />
      </label>

      <div className="timer-display">{formatTime(secondsLeft)}</div>

      <div className="btn-row">
        <button onClick={handleStart} disabled={isRunning || secondsLeft === 0}>
          ì‹œì‘
        </button>
        <button onClick={handlePause} disabled={!isRunning}>
          ì¼ì‹œì •ì§€
        </button>
        <button onClick={handleReset}>ë¦¬ì…‹</button>
      </div>
    </div>
  );
}

/* =========================
   2-2. ê³µë¶€ ëŒ€ê²° ë°©
   ========================= */
function StudyRooms({ pomodoroCount }) {
  const [joinedRoom, setJoinedRoom] = useState(null);

  const rooms = [
    { id: 1, name: "ì•„ì¹¨í˜• ê³µë¶€ë°©", avgPomodoro: 3, members: 8 },
    { id: 2, name: "ë°¤ìƒ˜ ì½”ë”©ë°©", avgPomodoro: 5, members: 12 },
    { id: 3, name: "ì€ë‘” íƒˆì¶œ ì±Œë¦°ì§€ë°©", avgPomodoro: 2, members: 6 },
  ];

  return (
    <div className="card">
      <h2>âš” ê³µë¶€ ëŒ€ê²° ë°©</h2>
      <p className="sub">
        ë°©ì— ì°¸ì—¬í•´ì„œ ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ ë½€ëª¨ë„ë¡œ ê°œìˆ˜ë¥¼ ë¹„êµí•˜ë©°  
        ê²Œì„ì²˜ëŸ¼ ê³µë¶€í•  ìˆ˜ ìˆëŠ” ê°€ìƒì˜ ê³µê°„ì…ë‹ˆë‹¤. (ë°ëª¨ ë²„ì „)
      </p>

      <ul className="room-list">
        {rooms.map((room) => (
          <li
            key={room.id}
            className={
              joinedRoom === room.id ? "room-item room-item-joined" : "room-item"
            }
          >
            <div>
              <div className="room-name">{room.name}</div>
              <div className="room-sub">
                í‰ê·  ë½€ëª¨ë„ë¡œ: {room.avgPomodoro}íšŒ / ì¸ì› {room.members}ëª…
              </div>
            </div>
            {joinedRoom === room.id ? (
              <span className="badge">ì°¸ì—¬ ì¤‘</span>
            ) : (
              <button onClick={() => setJoinedRoom(room.id)}>ì…ì¥</button>
            )}
          </li>
        ))}
      </ul>

      {joinedRoom && (
        <div className="card inner">
          <h3>í˜„ì¬ ë°© ë‚´ ë‚˜ì˜ ê¸°ë¡</h3>
          <p>ì˜¤ëŠ˜ ì™„ë£Œí•œ ë½€ëª¨ë„ë¡œ: {pomodoroCount}íšŒ</p>
          <p className="sub">
            ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ì—¬ê¸°ì„œ ë‹¤ë¥¸ ì‚¬ëŒê³¼ì˜ ìˆœìœ„ ë¹„êµ,  
            ë­í‚¹, ì¶”ê°€ ë³´ìƒ ë“±ìœ¼ë¡œ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </p>
        </div>
      )}
    </div>
  );
}

/* =========================
   3-1. ì±—ë´‡ ëŒ€í™”
   ========================= */
function ChatbotSection({ level }) {
  const [messages, setMessages] = useState([
    { from: "bot", text: "ì•ˆë…•! ì˜¤ëŠ˜ì€ ì–´ë–¤ ì‘ì€ ëª©í‘œë¶€í„° ì‹œì‘í•´ë³¼ê¹Œ?" },
  ]);
  const [input, setInput] = useState("");

  const handleSend = () => {
    if (!input.trim()) return;
    const userMsg = { from: "user", text: input.trim() };

    let reply = "ê·¸ ë§ì„ ë“¤ìœ¼ë‹ˆê¹Œ, ì•„ì£¼ ì‘ì€ ëª©í‘œ í•˜ë‚˜ë§Œ ì •í•´ë³´ëŠ” ê±´ ì–´ë•Œ?";
    const text = input.trim();

    if (text.includes("í•˜ê¸° ì‹«") || text.includes("ê·€ì°®")) {
      reply = "ê·¸ëŸ´ ë•ŒëŠ” '5ë¶„ë§Œ í•´ë³´ê¸°'ë¥¼ ì¶”ì²œí• ê²Œ. 5ë¶„ í›„ì— ë©ˆì¶°ë„ ê´œì°®ì•„!";
    } else if (text.includes("ë¶ˆì•ˆ") || text.includes("ê±±ì •")) {
      reply = "ë¶ˆì•ˆí•œ ë§ˆìŒì„ ì ì–´ë³´ëŠ” ê²ƒë„ ë„ì›€ì´ ë¼. ê·¸ë¦¬ê³  ì§€ê¸ˆ í•  ìˆ˜ ìˆëŠ” í–‰ë™ì„ í•˜ë‚˜ë§Œ ê³¨ë¼ë³´ì.";
    } else if (text.includes("ì€ë‘”") || text.includes("ì‚¬ëŒ")) {
      reply =
        "ì‚¬ëŒë“¤ì„ ë°”ë¡œ ë§Œë‚˜ëŠ” ê²Œ ë¶€ë‹´ëœë‹¤ë©´, ë¨¼ì € ìµëª… í•œì¤„ ëŒ€í™”ë¶€í„° ì‹œë„í•´ë³´ëŠ” ê±´ ì–´ë•Œ?";
    }

    const botMsg = { from: "bot", text: reply };
    setMessages((prev) => [...prev, userMsg, botMsg]);
    setInput("");
  };

  return (
    <div className="card">
      <h2> ë‹¨ê³„ 1: ì±—ë´‡ê³¼ ëŒ€í™”í•˜ê¸°</h2>
      <p className="sub">
        ê³µë¶€ ì˜ì§€Â·ê°ì • ìƒíƒœì— ëŒ€í•´ ê°€ë³ê²Œ ì´ì•¼ê¸°í•˜ë©´ì„œ,  
        ë‹¤ìŒì— í•  í–‰ë™ì„ í•¨ê»˜ ì •í•´ë³´ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤. (í˜„ì¬ ë ˆë²¨: {level})
      </p>

      <div className="chat-window">
        {messages.map((m, idx) => (
          <div
            key={idx}
            className={m.from === "bot" ? "chat-bot" : "chat-user"}
          >
            {m.text}
          </div>
        ))}
      </div>

      <div className="chat-input-row">
        <input
          type="text"
          placeholder="ì§€ê¸ˆ ìƒíƒœë‚˜ ê³ ë¯¼ì„ ì ì–´ë³´ì„¸ìš”..."
          value={input}
          onChange={(e) => setInput(e.target.value)}
          onKeyDown={(e) => e.key === "Enter" && handleSend()}
        />
        <button onClick={handleSend}>ì „ì†¡</button>
      </div>
    </div>
  );
}

/* =========================
   3-2. ìµëª… í•œì¤„ ì±„íŒ…
   ========================= */
function AnonymousChatSection({ level }) {
  const [messages, setMessages] = useState([
    { nickname: "ìµëª…1", text: "ì˜¤ëŠ˜ì€ ë°©ì—ì„œ ë‚˜ì™€ì„œ ë„ì„œê´€ì—ì„œ ê³µë¶€ ì‹œì‘í–ˆì–´ìš”." },
    { nickname: "ìµëª…2", text: "ì˜¤ëœë§Œì— ì‚°ì±… ë‚˜ê°”ë‹¤ ì™”ì–´ìš” :)" },
  ]);
  const [input, setInput] = useState("");

  if (level < 2) {
    return (
      <div className="card card-locked">
        <h2> ë‹¨ê³„ 2: ìµëª… í•œì¤„ ëŒ€í™”</h2>
        <p>
          ë ˆë²¨ 2ë¶€í„° í•´ê¸ˆë©ë‹ˆë‹¤.  
          ë½€ëª¨ë„ë¡œ / ì‘ì€ ëª©í‘œ / í™œë™ ê¸°ë¡ìœ¼ë¡œ XPë¥¼ ëª¨ìœ¼ë©´ ì ê¸ˆì´ í’€ë ¤ìš”.
        </p>
      </div>
    );
  }

  const handleSend = () => {
    if (!input.trim()) return;
    const newMsg = { nickname: "ë‚˜(ìµëª…)", text: input.trim() };
    setMessages((prev) => [...prev, newMsg]);
    setInput("");
  };

  return (
    <div className="card">
      <h2> ë‹¨ê³„ 2: ìµëª… í•œì¤„ ëŒ€í™”</h2>
      <p className="sub">
        ë‹‰ë„¤ì„ë§Œ ë³´ì´ëŠ” ìµëª… ê³µê°„ì…ë‹ˆë‹¤. ê¸¸ê²Œ ë§í•˜ì§€ ì•Šì•„ë„ ê´œì°®ì•„ìš”.  
        ì˜¤ëŠ˜ í•œ í–‰ë™ì´ë‚˜ ëŠë‚€ ì ì„ í•œ ì¤„ë§Œ ë‚¨ê²¨ë³´ì„¸ìš”.
      </p>

      <div className="anon-window">
        {messages.map((m, idx) => (
          <div key={idx} className="anon-msg">
            <strong>{m.nickname}:</strong> {m.text}
          </div>
        ))}
      </div>

      <div className="chat-input-row">
        <input
          type="text"
          placeholder="ì˜¤ëŠ˜ì˜ í•œ ì¤„ì„ ë‚¨ê²¨ë³´ì„¸ìš”..."
          value={input}
          onChange={(e) => setInput(e.target.value)}
          onKeyDown={(e) => e.key === "Enter" && handleSend()}
        />
        <button onClick={handleSend}>ì „ì†¡</button>
      </div>
    </div>
  );
}

/* =========================
   3-3. ì „í™” / ì˜ìƒ í†µí™” + ìŠ¤í‹°ì»¤ (UI ë°ëª¨)
   ========================= */
function CallSection({ level }) {
  if (level < 3) {
    return (
      <div className="card card-locked">
        <h2> ë‹¨ê³„ 3: ìŒì„± Â· ì˜ìƒ í†µí™”(ìŠ¤í‹°ì»¤)</h2>
        <p>
          ë ˆë²¨ 3ë¶€í„° í•´ê¸ˆë©ë‹ˆë‹¤.  
          ì±—ë´‡ â†’ ìµëª… ëŒ€í™” â†’ í†µí™” ìˆœì„œë¡œ, ì‚¬ëŒê³¼ì˜ ì—°ê²°ì„ ë‹¨ê³„ì ìœ¼ë¡œ í™•ì¥í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.
        </p>
      </div>
    );
  }

  return (
    <div className="card">
      <h2> ë‹¨ê³„ 3: ìŒì„± Â· ì˜ìƒ í†µí™” (ìŠ¤í‹°ì»¤)</h2>
      <p className="sub">
        ì´ ì˜ì—­ì€ ì‹¤ì œ í†µí™” ê¸°ëŠ¥ ëŒ€ì‹ ,  
        â€œì–´ë–»ê²Œ í™•ì¥ë  ìˆ˜ ìˆëŠ”ì§€â€ë¥¼ ë³´ì—¬ì£¼ëŠ” UI ë°ëª¨ì…ë‹ˆë‹¤.
      </p>

      <div className="call-layout">
        <div className="call-box">
          <h3> ìŒì„± í†µí™”</h3>
          <p>ìƒëŒ€ë°©ê³¼ ë¶€ë‹´ ì—†ì´ ëª©ì†Œë¦¬ë¡œë§Œ ëŒ€í™”í•  ìˆ˜ ìˆëŠ” ëª¨ë“œì…ë‹ˆë‹¤.</p>
          <button>ìŒì„± í†µí™” ìš”ì²­í•˜ê¸° (ë°ëª¨)</button>
        </div>

        <div className="call-box">
          <h3> ì˜ìƒ í†µí™” + ì–¼êµ´ ìŠ¤í‹°ì»¤</h3>
          <p>
            ì–¼êµ´ ì „ì²´ê°€ ë³´ì´ëŠ” ê²ƒì´ ë¶€ë‹´ëœë‹¤ë©´,  
            ì–¼êµ´ ìœ„ì— ìŠ¤í‹°ì»¤ë¥¼ ì–¹ì–´ì„œ ì˜ìƒ í†µí™”ë¥¼ í•  ìˆ˜ ìˆëŠ” ëª¨ë“œì…ë‹ˆë‹¤.
          </p>
          <div className="video-preview">
            <div className="face-placeholder"></div>
            <div className="sticker"> ìŠ¤í‹°ì»¤</div>
          </div>
          <button>ì˜ìƒ í†µí™” ì‹œì‘ (ë°ëª¨)</button>
        </div>
      </div>

      <p className="sub">
        ì€ë‘”í˜•Â·ì‰¬ì—ˆìŒ ì„¸ëŒ€ê°€  
        â€œí…ìŠ¤íŠ¸ â†’ ìŒì„± â†’ ì˜ìƒ(ìŠ¤í‹°ì»¤)â€ ìˆœì„œë¡œ  
        ë¶€ë‹´ì„ ì¤„ì´ë©´ì„œ ì‚¬íšŒ í™œë™ì„ íšŒë³µí•˜ë„ë¡ ì„¤ê³„í–ˆë‹¤ëŠ” ì ì„  
        ë³´ê³ ì„œ/ë°œí‘œì—ì„œ ê°•ì¡°í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤.
      </p>
    </div>
  );
}

/* =========================
   ë³´ìƒ / ë ˆë²¨ ìƒíƒœ
   ========================= */
function RewardStatus({ xp, level, pomodoroCount }) {
  const nextLevelXp = level * 100;
  const currentLevelXp = (level - 1) * 100;
  const progress = Math.min(
    100,
    ((xp - currentLevelXp) / (nextLevelXp - currentLevelXp)) * 100
  );

  return (
    <div className="card reward-card">
      <h2> ë‚˜ì˜ ë³´ìƒ & ë ˆë²¨</h2>
      <p>
        í˜„ì¬ ë ˆë²¨: <strong>Lv.{level}</strong>
      </p>
      <p>ì´ ê²½í—˜ì¹˜: {xp} XP</p>
      <div className="progress-bar">
        <div className="progress-inner" style={{ width: `${progress}%` }} />
      </div>
      <p className="sub">
        ë‹¤ìŒ ë ˆë²¨ê¹Œì§€{" "}
        {nextLevelXp - xp > 0 ? nextLevelXp - xp : 0} XP ë‚¨ì•˜ìŠµë‹ˆë‹¤.  
        (ì‘ì€ ëª©í‘œ, í™œë™ ê¸°ë¡, ë½€ëª¨ë„ë¡œë¥¼ í†µí•´ XPë¥¼ ì–»ì„ ìˆ˜ ìˆì–´ìš”.)
      </p>
      <p>ì˜¤ëŠ˜ ì™„ë£Œí•œ ë½€ëª¨ë„ë¡œ: {pomodoroCount}íšŒ</p>
      <ul className="sub-list">
        <li>Lv.1: ì±—ë´‡ ëŒ€í™” ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥</li>
        <li>Lv.2: ìµëª… í•œì¤„ ëŒ€í™” í•´ê¸ˆ</li>
        <li>Lv.3: ìŒì„± Â· ì˜ìƒ í†µí™” UI í•´ê¸ˆ</li>
      </ul>
    </div>
  );
}

/* =========================
   ë©”ì¸ ì•±
   ========================= */
function App() {
  const { xp, level, addXp } = useRewardSystem();
  const [pomodoroCount, setPomodoroCount] = useState(0);

  const handlePomodoroComplete = () => {
    setPomodoroCount((prev) => prev + 1);
    addXp(50); // ë½€ëª¨ë„ë¡œ 1ì„¸ì…˜ = 50XP
    alert("ì¶•í•˜í•©ë‹ˆë‹¤! ë½€ëª¨ë„ë¡œ 1ì„¸ì…˜ì„ ì™„ë£Œí–ˆì–´ìš”. XP +50 ğŸ‰");
  };

  return (
    <div className="app">
      <header>
        <h1>ActiLink â€“ ì ê·¹ì„±Â·ê³µë¶€ì˜ì§€ & ì€ë‘”í˜•Â·ì‰¬ì—ˆìŒ ì„¸ëŒ€ ê°ì†Œ ì•±</h1>
        <p>
          ì‘ì€ í–‰ë™ë¶€í„° ì‹œì‘í•´ì„œ,  
          ê³µë¶€ ì˜ì§€ í–¥ìƒê³¼ ì‚¬íšŒì  ì—°ê²° íšŒë³µì„ ë™ì‹œì— ë•ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.
        </p>
      </header>

      <main>
        {/* ìƒë‹¨: ë³´ìƒ/ë ˆë²¨ + ë§ˆì´í¬ë¡œ ê³¨ + í™œë™ ê¸°ë¡ */}
        <section className="section-grid">
          <RewardStatus xp={xp} level={level} pomodoroCount={pomodoroCount} />
          <MicroGoalsSection addXp={addXp} />
          <ActivityTrackerSection addXp={addXp} />
        </section>

        {/* ì¤‘ê°„: ë½€ëª¨ë„ë¡œ + ê³µë¶€ë°© */}
        <section className="section-grid">
          <PomodoroTimer onComplete={handlePomodoroComplete} />
          <StudyRooms pomodoroCount={pomodoroCount} />
        </section>

        {/* í•˜ë‹¨: ì±—ë´‡ + ìµëª… ì±„íŒ… + í†µí™” */}
        <section className="section-grid">
          <ChatbotSection level={level} />
          <AnonymousChatSection level={level} />
          <CallSection level={level} />
        </section>
      </main>

      <footer>
        <p>
          GitHub + Vercel ë°°í¬ìš© ë°ëª¨ ì•± Â·  
          â€œì ê·¹ì„±, ê³µë¶€ ì˜ì§€ í–¥ìƒ, ì€ë‘”í˜• ì™¸í†¨ì´ ë° ì‰¬ì—ˆìŒ ì„¸ëŒ€ ê°ì†Œâ€ë¥¼ ëª©í‘œë¡œ ì„¤ê³„ëœ ì˜ˆì‹œì…ë‹ˆë‹¤.
        </p>
      </footer>

      {/* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */}
      <style>{`
        * { box-sizing: border-box; }
        body { margin: 0; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
        .app {
          min-height: 100vh;
          background: linear-gradient(135deg, #0f172a, #020617);
          color: #e5e7eb;
          padding: 20px;
        }
        header {
          text-align: center;
          margin-bottom: 20px;
        }
        header h1 {
          font-size: 1.7rem;
          margin-bottom: 0.3rem;
        }
        header p {
          font-size: 0.9rem;
          color: #9ca3af;
        }
        main {
          max-width: 1200px;
          margin: 0 auto;
          display: flex;
          flex-direction: column;
          gap: 18px;
        }
        .section-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
          gap: 16px;
        }
        .card {
          background: #020617;
          border-radius: 12px;
          padding: 16px;
          border: 1px solid #1f2937;
          box-shadow: 0 8px 20px rgba(0, 0, 0, 0.35);
        }
        .card.inner {
          background: #020617;
          border-style: dashed;
        }
        .card-locked {
          opacity: 0.55;
        }
        .reward-card {
          margin-bottom: 10px;
        }
        h2 {
          font-size: 1.2rem;
          margin-bottom: 0.4rem;
        }
        h3 {
          margin-top: 0;
        }
        .sub {
          font-size: 0.85rem;
          color: #9ca3af;
        }
        .sub-list {
          font-size: 0.8rem;
          color: #9ca3af;
          padding-left: 18px;
        }
        input[type="number"],
        input[type="text"] {
          margin-left: 6px;
          margin-top: 4px;
          padding: 4px 8px;
          border-radius: 6px;
          border: 1px solid #374151;
          background: #020617;
          color: #e5e7eb;
        }
        .timer-display {
          font-size: 2rem;
          text-align: center;
          margin: 12px 0;
          font-weight: bold;
        }
        .btn-row {
          display: flex;
          gap: 8px;
          justify-content: center;
          flex-wrap: wrap;
        }
        button {
          padding: 6px 12px;
          border-radius: 999px;
          border: none;
          background: #2563eb;
          color: white;
          font-size: 0.85rem;
          cursor: pointer;
        }
        button:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }
        button:hover:not(:disabled) {
          background: #1d4ed8;
        }

        footer {
          margin-top: 20px;
          text-align: center;
          font-size: 0.75rem;
          color: #6b7280;
        }

        /* ì˜¤ëŠ˜ì˜ ì‘ì€ ëª©í‘œ */
        .goal-list {
          list-style: none;
          padding: 0;
          margin: 8px 0;
        }
        .goal-item {
          margin-bottom: 6px;
          font-size: 0.9rem;
        }
        .goal-item input {
          margin-right: 6px;
        }
        .goal-done {
          text-decoration: line-through;
          color: #22c55e;
        }
        .goal-footer {
          margin-top: 8px;
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 0.8rem;
        }

        /* í™œë™ ê¸°ë¡ */
        .activity-buttons {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
          margin: 8px 0;
        }
        .activity-chart {
          margin-top: 8px;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }
        .activity-row {
          font-size: 0.8rem;
        }
        .activity-label {
          margin-bottom: 2px;
        }
        .activity-bar-bg {
          width: 100%;
          height: 8px;
          background: #020617;
          border-radius: 999px;
          border: 1px solid #1f2937;
          overflow: hidden;
        }
        .activity-bar-fill {
          height: 100%;
          background: linear-gradient(90deg, #22c55e, #a3e635);
        }

        /* ê³µë¶€ë°© */
        .room-list {
          list-style: none;
          padding: 0;
          margin: 8px 0;
          display: flex;
          flex-direction: column;
          gap: 8px;
        }
        .room-item {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 8px 10px;
          border-radius: 8px;
          background: #020617;
          border: 1px solid #1f2937;
        }
        .room-item-joined {
          border-color: #22c55e;
          background: #022c22;
        }
        .room-name {
          font-weight: 600;
        }
        .room-sub {
          font-size: 0.8rem;
          color: #9ca3af;
        }
        .badge {
          font-size: 0.75rem;
          background: #22c55e;
          color: #022c22;
          padding: 4px 8px;
          border-radius: 999px;
          font-weight: 600;
        }

        /* ì±„íŒ… ê³µí†µ */
        .chat-window,
        .anon-window {
          margin-top: 10px;
          border-radius: 8px;
          border: 1px solid #1f2937;
          background: #020617;
          padding: 8px;
          max-height: 220px;
          overflow-y: auto;
          font-size: 0.85rem;
        }
        .chat-bot,
        .chat-user {
          margin-bottom: 6px;
          padding: 6px 8px;
          border-radius: 8px;
          max-width: 80%;
        }
        .chat-bot {
          background: #0f172a;
          align-self: flex-start;
        }
        .chat-user {
          background: #1d4ed8;
          margin-left: auto;
          text-align: right;
        }
        .chat-input-row {
          display: flex;
          gap: 6px;
          margin-top: 8px;
        }
        .chat-input-row input {
          flex: 1;
        }
        .anon-msg {
          padding: 4px 0;
        }

        /* í†µí™” ì˜ì—­ */
        .call-layout {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
          gap: 12px;
          margin-top: 8px;
        }
        .call-box {
          border-radius: 8px;
          border: 1px solid #1f2937;
          padding: 10px;
          background: #020617;
        }
        .video-preview {
          position: relative;
          margin: 8px 0;
          height: 150px;
          border-radius: 10px;
          border: 1px dashed #4b5563;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .face-placeholder {
          font-size: 3rem;
        }
        .sticker {
          position: absolute;
          top: 20px;
          right: 20px;
          font-size: 1.5rem;
          background: rgba(15, 23, 42, 0.8);
          padding: 4px 8px;
          border-radius: 999px;
        }

        /* ë ˆë²¨ ì§„í–‰ë°” */
        .progress-bar {
          width: 100%;
          height: 10px;
          background: #020617;
          border-radius: 999px;
          border: 1px solid #1f2937;
          margin: 4px 0 8px;
          overflow: hidden;
        }
        .progress-inner {
          height: 100%;
          background: linear-gradient(90deg, #22c55e, #a3e635);
        }

        @media (max-width: 600px) {
          header h1 {
            font-size: 1.4rem;
          }
          .card {
            padding: 12px;
          }
        }
      `}</style>
    </div>
  );
}

export default App;
