<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Re:Connect+ â€“ AI ê¸°ë°˜ ë£¨í‹´ & ì—°ê²° í”Œë«í¼</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #f5f7fb;
      --card: #ffffff;
      --border: #e5e7eb;
      --text: #1f2937;
      --text-light: #6b7280;
      --primary: #2563eb;
      --primary-soft: #dbeafe;
      --radius: 14px;
      --shadow: 0 4px 14px rgba(0,0,0,0.08);
      --shadow-lg: 0 10px 24px rgba(0,0,0,0.12);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      color: var(--text);
    }

    .app {
      max-width: 1150px;
      margin: 0 auto;
      padding: 20px;
    }

    /* í—¤ë” */
    header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 18px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      width: 42px;
      height: 42px;
      border-radius: 14px;
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.1rem;
      box-shadow: var(--shadow);
    }

    .logo-title { font-size: 1.3rem; font-weight: 700; }

    .logo-subtitle { font-size: 0.82rem; color: var(--text-light); }

    .tagline { font-size: 0.75rem; color: var(--text-light); text-align: right; }

    /* ìƒë‹¨ ìƒíƒœ ë°•ìŠ¤ */
    .status-row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .status-box {
      flex: 1;
      min-width: 180px;
      background: var(--card);
      padding: 14px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
    }

    .status-label { font-size: 0.78rem; color: var(--text-light); }
    .status-value { font-size: 1.05rem; font-weight: 700; margin-top: 4px; }

    /* ë©”ì¸ íƒ­ */
    .tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .tab-btn {
      flex: 1;
      min-width: 120px;
      padding: 10px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: #ffffff;
      font-size: 0.83rem;
      color: var(--text);
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: 0.2s;
    }

    .tab-btn.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
      box-shadow: var(--shadow-lg);
    }

    /* ê³µí†µ ì¹´ë“œ */
    .card {
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      padding: 20px;
      margin-bottom: 20px;
    }

    .card-title { font-weight: 700; font-size: 1rem; margin-bottom: 4px; }
    .card-sub { font-size: 0.8rem; color: var(--text-light); margin-bottom: 16px; }

    /* XP ë°” */
    .xp-container { margin-bottom: 18px; }
    .xp-header {
      display: flex;
      justify-content: space-between;
      font-size: 0.75rem;
      color: var(--text-light);
    }
    .xp-bar {
      width: 100%;
      height: 10px;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
      margin-top: 6px;
    }
    .xp-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #3b82f6, #2563eb);
      transition: width 0.25s;
    }

    /* ë¯¸ì…˜ ë¦¬ìŠ¤íŠ¸ */
    .mission-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }

    .mission-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 14px;
      background: var(--bg);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
    }

    .mission-item.completed {
      opacity: 0.6;
      text-decoration: line-through;
    }

    /* ê°ì • ì…ë ¥ */
    .emotion-box {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: var(--shadow);
    }

    .emotion-input {
      width: 100%;
      padding: 10px;
      font-size: 0.82rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      margin-top: 8px;
    }

    .btn {
      margin-top: 10px;
      padding: 10px 16px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      font-size: 0.82rem;
      cursor: pointer;
    }

    .btn.secondary {
      background: #ffffff;
      color: var(--primary);
      border: 1px solid var(--primary-soft);
      box-shadow: none;
      margin-top: 6px;
    }

    .section { display: none; }
    .section.active { display: block; }

    /* Social Mission */
    .difficulty-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    .difficulty-btn {
      flex: 1;
      min-width: 90px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #ffffff;
      font-size: 0.8rem;
      cursor: pointer;
      color: var(--text-light);
    }

    .difficulty-btn.active {
      background: var(--primary-soft);
      border-color: var(--primary);
      color: var(--primary);
      font-weight: 600;
    }

    .mission-card {
      padding: 16px;
      border-radius: var(--radius);
      background: var(--bg);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      font-size: 0.86rem;
    }

    /* Social ë‚´ë¶€ */
    .social-subtabs {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }

    .social-sub-btn {
      flex: 1;
      padding: 8px 10px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: #ffffff;
      font-size: 0.8rem;
      cursor: pointer;
      color: var(--text-light);
    }

    .social-sub-btn.active {
      background: var(--primary-soft);
      border-color: var(--primary);
      color: var(--primary);
      font-weight: 600;
    }

    .social-box { }

    /* ì±„íŒ…ì°½ */
    #chat-window {
      height: 170px;
      background: #ffffff;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 10px;
      overflow-y: auto;
      margin-bottom: 8px;
    }

    .chat-bubble {
      max-width: 75%;
      padding: 8px 10px;
      border-radius: 14px;
      margin-bottom: 6px;
      white-space: pre-wrap;
      font-size: 0.8rem;
    }

    .chat-ai { background: #f1f5f9; }
    .chat-user { background: #dbeafe; margin-left: auto; }

    /* ë¦¬í¬íŠ¸ */
    .report-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px,1fr));
      gap: 12px;
    }

    .report-card {
      padding: 14px;
      border-radius: var(--radius);
      background: var(--card);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
    }

    .report-label { font-size: 0.78rem; color: var(--text-light); }
    .report-value { font-size: 1.3rem; font-weight: 700; margin-top: 4px; }

    @media (max-width: 640px) {
      .app { padding: 12px; }
      header { align-items: flex-start; }
    }
  </style>
</head>

<body>
<div class="app">
  <!-- í—¤ë” -->
  <header>
    <div class="logo">
      <div class="logo-icon">R</div>
      <div>
        <div class="logo-title">Re:Connect+</div>
        <div class="logo-subtitle">AI ê¸°ë°˜ ë£¨í‹´ & ì—°ê²° í”Œë«í¼</div>
      </div>
    </div>
    <div class="tagline">
      ì ê·¹ì„± Â· ê³µë¶€ ì˜ì§€ Â· ì‚¬íšŒì  ì—°ê²°ì„<br/>ì‘ì€ í–‰ë™ë¶€í„° íšŒë³µí•˜ëŠ” ì•±
    </div>
  </header>

  <!-- ìƒë‹¨ ìƒíƒœ -->
  <div class="status-row">
    <div class="status-box">
      <div class="status-label">í˜„ì¬ ë ˆë²¨</div>
      <div class="status-value" id="level-display">1</div>
    </div>
    <div class="status-box">
      <div class="status-label">ì´ XP</div>
      <div class="status-value" id="xp-display">0</div>
    </div>
    <div class="status-box">
      <div class="status-label">ì˜¤ëŠ˜ ì™„ë£Œí•œ ë¯¸ì…˜</div>
      <div class="status-value" id="today-goals-count">0</div>
    </div>
  </div>

  <!-- ë©”ì¸ íƒ­ -->
  <div class="tabs">
    <button class="tab-btn active" data-tab="home">ğŸ  í™ˆ</button>
    <button class="tab-btn" data-tab="mission">ğŸ¯ Social Mission</button>
    <button class="tab-btn" data-tab="rival">ğŸ® Rival</button>
    <button class="tab-btn" data-tab="social">ğŸ’¬ Social</button>
    <button class="tab-btn" data-tab="report">ğŸ“Š ë¦¬í¬íŠ¸</button>
  </div>

  <!-- ë©”ì¸ ì¹´ë“œ -->
  <div class="card">
    <div class="card-title" id="main-title">ì˜¤ëŠ˜ì˜ ì‘ì€ ë£¨í‹´</div>
    <div class="card-sub" id="main-sub">ì‘ì€ í–‰ë™ì„ í•˜ë©´ XPê°€ ìŒ“ì…ë‹ˆë‹¤.</div>

    <!-- HOME -->
    <div class="section active" id="section-home">
      <div class="xp-container">
        <div class="xp-header">
          <span>ë ˆë²¨ <span id="level-inline">1</span></span>
          <span><span id="xp-inline">0</span> XP</span>
        </div>
        <div class="xp-bar"><div class="xp-fill" id="xp-fill"></div></div>
      </div>

      <div class="mission-list" id="mission-list"></div>

      <div class="emotion-box">
        <div style="font-size:0.8rem;">ì˜¤ëŠ˜ ê¸°ë¶„ì€ ì–´ë• ë‚˜ìš”?</div>
        <input id="emotion-input" class="emotion-input" placeholder="ì˜ˆ: ì•„ë¬´ê²ƒë„ í•˜ê¸° ì‹«ì—ˆì–´ìš”..." />
        <button id="emotion-btn" class="btn">ê¸°ë¡ + AI í•œë§ˆë””</button>
        <div id="emotion-response" style="font-size:0.75rem; margin-top:6px; color:var(--text-light);"></div>
      </div>
    </div>

    <!-- SOCIAL MISSION -->
    <div class="section" id="section-mission">
      <div style="margin-bottom:8px;font-size:0.9rem;font-weight:600;">
        ë‚œì´ë„ ì„ íƒí˜• ì‚¬íšŒì  ë¯¸ì…˜
      </div>
      <div style="font-size:0.8rem;color:var(--text-light);margin-bottom:10px;">
        ì€ë‘”í˜• ì™¸í†¨ì´Â·ì‰¬ì—ˆìŒ ì„¸ëŒ€ë¥¼ ìœ„í•´, <strong>ì´ˆë³´/ë³´í†µ/ê³ ê¸‰</strong> ìˆ˜ì¤€ì— ë§ëŠ”
        ì‘ì€ ì‚¬íšŒì  í–‰ë™ ë¯¸ì…˜ì„ ì¶”ì²œí•©ë‹ˆë‹¤.
      </div>

      <div class="difficulty-row">
        <button class="difficulty-btn active" data-diff="easy">ì´ˆë³´</button>
        <button class="difficulty-btn" data-diff="medium">ë³´í†µ</button>
        <button class="difficulty-btn" data-diff="hard">ê³ ê¸‰</button>
      </div>

      <div class="mission-card">
        <div style="font-size:0.78rem;color:var(--text-light);">ì˜¤ëŠ˜ì˜ ë¯¸ì…˜</div>
        <div id="social-mission-text" style="margin-top:6px;font-size:0.9rem;font-weight:600;">
          ë¡œë”© ì¤‘...
        </div>
        <div id="social-mission-xp" style="margin-top:4px;font-size:0.78rem;color:var(--text-light);">
          ì™„ë£Œ ì‹œ +20 XP
        </div>

        <button id="social-mission-refresh" class="btn secondary">ë‹¤ì‹œ ë½‘ê¸°</button>
        <button id="social-mission-complete" class="btn">ë¯¸ì…˜ ì™„ë£Œí•˜ê¸°</button>

        <div id="social-mission-msg" style="margin-top:8px;font-size:0.78rem;color:var(--text-light);">
        </div>
      </div>
    </div>

    <!-- RIVAL -->
    <div class="section" id="section-rival">
      <div style="margin-bottom:14px;font-size:0.9rem;font-weight:600;">
        AI Rival ì ìˆ˜ ê²½ìŸ
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
        <div class="card" style="padding:14px;">
          <div style="font-size:0.82rem;color:var(--text-light);">ë‚˜ì˜ ì˜¤ëŠ˜ ì ìˆ˜</div>
          <div id="my-score" style="font-size:1.4rem;font-weight:700;margin-top:6px;">0</div>
        </div>

        <div class="card" style="padding:14px;">
          <div id="rival-name" style="font-size:0.82rem;color:var(--text-light);">AI Rival (GPT)</div>
          <div id="rival-score" style="font-size:1.4rem;font-weight:700;margin-top:6px;color:#dc2626;">0</div>
        </div>
      </div>

      <div id="rival-result" style="margin-top:12px;font-size:0.82rem;color:var(--text-light);">
        ì˜¤ëŠ˜ì€ ì•„ì§ ì ìˆ˜ê°€ ê³„ì‚°ë˜ì§€ ì•Šì•˜ì–´ìš”.
      </div>

      <button id="rival-recalc" class="btn" style="margin-top:14px;">ì ìˆ˜ ë‹¤ì‹œ ê³„ì‚°í•˜ê¸°</button>
    </div>

    <!-- SOCIAL -->
    <div class="section" id="section-social">
      <div style="margin-bottom:14px;font-size:0.9rem;font-weight:600;">
        Social Connect
      </div>

      <div class="social-subtabs">
        <button class="social-sub-btn active" data-social="ai-chat">AI ëŒ€í™”</button>
        <button class="social-sub-btn" data-social="anon">ìµëª… ì±„íŒ…(êµ¬ìƒ)</button>
        <button class="social-sub-btn" data-social="voice">ë³´ì´ìŠ¤í†¡(êµ¬ìƒ)</button>
      </div>

      <!-- AI Chat -->
      <div class="social-box" id="social-ai-chat">
        <div id="chat-window">
          <div class="chat-bubble chat-ai">
            ì•ˆë…•í•˜ì„¸ìš”! í¸í•˜ê²Œ ë§ ê±¸ì–´ì£¼ì„¸ìš” ğŸ˜Š
          </div>
        </div>
        <input id="chat-input" class="emotion-input" placeholder="ì˜ˆ: ì˜¤ëŠ˜ ì¢€ í˜ë“¤ì—ˆì–´ìš”..." />
        <button id="chat-send" class="btn">ì „ì†¡</button>
      </div>

      <!-- ìµëª… ì±„íŒ… ì•ˆë‚´ -->
      <div class="social-box" id="social-anon" style="display:none;">
        <div style="padding:14px;border-radius:var(--radius);background:var(--bg);border:1px solid var(--border);font-size:0.8rem;">
          ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” <strong>ëœë¤ ìµëª… ë‹‰ë„¤ì„</strong>ìœ¼ë¡œ ì ‘ì†í•˜ì—¬
          ê³µë¶€ ì¸ì¦, ê°ì • ë‚˜ëˆ” ë“±ì„ í•  ìˆ˜ ìˆëŠ” ì±„íŒ…ë°©ìœ¼ë¡œ í™•ì¥í•  ì˜ˆì •ì…ë‹ˆë‹¤.
          ì´ ë°ëª¨ì—ì„œëŠ” ê¸°íš ì˜ë„ë§Œ ë³´ì—¬ì¤ë‹ˆë‹¤.
        </div>
      </div>

      <!-- ë³´ì´ìŠ¤í†¡ ì•ˆë‚´ -->
      <div class="social-box" id="social-voice" style="display:none;">
        <div style="padding:14px;border-radius:var(--radius);background:var(--bg);border:1px solid var(--border);font-size:0.8rem;">
          ì „í™”ë²ˆí˜¸ ì—†ì´ ì•± ë‚´ë¶€ì—ì„œë§Œ í†µí™”ë˜ëŠ” <strong>ìµëª… ë³´ì´ìŠ¤í†¡</strong> ê¸°ëŠ¥ì„
          ê³„íš ì¤‘ì…ë‹ˆë‹¤. ì€ë‘”í˜• ì™¸í†¨ì´ë„ ë¶€ë‹´ ì—†ì´ ì§§ì€ ëŒ€í™”ë¥¼ ì‹œë„í•  ìˆ˜ ìˆë„ë¡
          3~5ë¶„ ì œí•œ í†µí™”ë¡œ ì„¤ê³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>
      </div>
    </div>

    <!-- REPORT -->
    <div class="section" id="section-report">
      <div style="margin-bottom:14px;font-size:0.9rem;font-weight:600;">
        í™œë™ ë¦¬í¬íŠ¸ ìš”ì•½
      </div>

      <div class="report-grid">
        <div class="report-card">
          <div class="report-label">ëˆ„ì  ì™„ë£Œí•œ ê¸°ë³¸ ë¯¸ì…˜</div>
          <div class="report-value" id="report-goals">0</div>
        </div>
        <div class="report-card">
          <div class="report-label">ê°ì • ê¸°ë¡ ìˆ˜</div>
          <div class="report-value" id="report-emotions">0</div>
        </div>
        <div class="report-card">
          <div class="report-label">AI ëŒ€í™” ìˆ˜</div>
          <div class="report-value" id="report-chats">0</div>
        </div>
        <div class="report-card">
          <div class="report-label">ì‚¬íšŒì  ë¯¸ì…˜ ì™„ë£Œ ìˆ˜</div>
          <div class="report-value" id="report-social-missions">0</div>
        </div>
        <div class="report-card">
          <div class="report-label">ì˜¤ëŠ˜ì˜ ì ìˆ˜</div>
          <div class="report-value" id="report-today">0 ì </div>
        </div>
      </div>
    </div>
  </div> <!-- card ë -->

  <script>
    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ìƒíƒœ ì €ì¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const STORAGE_KEY = "reconnect_state_v3";
    let state = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");

    if (!state.xp && state.xp !== 0) {
      state = {
        xp: 0,
        level: 1,
        totalGoals: 0,
        todayGoals: 0,
        emotionLogs: 0,
        aiChats: 0,
        socialMissions: 0
      };
    }

    function saveState() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    function updateXPUI() {
      const level = Math.floor(state.xp / 50) + 1;
      state.level = level;

      document.getElementById("level-display").textContent = level;
      document.getElementById("xp-display").textContent = state.xp;
      document.getElementById("today-goals-count").textContent = state.todayGoals;
      document.getElementById("level-inline").textContent = level;
      document.getElementById("xp-inline").textContent = state.xp;

      const nextXP = level * 50;
      const fill = Math.min(100, (state.xp / nextXP) * 100);
      document.getElementById("xp-fill").style.width = fill + "%";
    }
    updateXPUI();

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ í™ˆ ë¯¸ì…˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const missions = [
      "ë¬¼ í•œ ì»µ ë§ˆì‹œê¸°",
      "5ë¶„ë§Œ ê³µë¶€í•˜ê¸°",
      "ë°© ì •ë¦¬ 1ë¶„ í•˜ê¸°",
      "ì°½ë¬¸ ì—´ê³  ë°”ëŒ ì¬ê¸°",
      "ì˜¤ëŠ˜ ëŠë‚€ ì  í•œ ì¤„ ì ê¸°"
    ];
    const missionListEl = document.getElementById("mission-list");

    missions.forEach((text) => {
      const item = document.createElement("div");
      item.className = "mission-item";

      const cb = document.createElement("input");
      cb.type = "checkbox";

      const label = document.createElement("span");
      label.textContent = text;

      cb.addEventListener("change", () => {
        if (cb.checked) {
          item.classList.add("completed");
          state.xp += 10;
          state.todayGoals++;
          state.totalGoals++;
        } else {
          item.classList.remove("completed");
        }
        saveState();
        updateXPUI();
        updateReport();
      });

      item.appendChild(cb);
      item.appendChild(label);
      missionListEl.appendChild(item);
    });

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ê°ì • ê¸°ë¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const emotionBtn = document.getElementById("emotion-btn");
    const emotionInput = document.getElementById("emotion-input");
    const emotionResponse = document.getElementById("emotion-response");

    const emotionMsgs = [
      "ê´œì°®ì•„ìš”. ì˜¤ëŠ˜ì€ ì‘ì€ ê²ƒ í•˜ë‚˜ë§Œ í•´ë´ìš”.",
      "í˜ë“  ë‚ ë„ ìˆì–´ìš”. ê·¸ë˜ë„ ê¸°ë¡í•œ ë‹¹ì‹ ì´ ëŒ€ë‹¨í•´ìš”.",
      "ì¡°ê¸ˆì”© ë‚˜ì•„ì§€ë©´ ë¼ìš”. ì €ëŠ” í•­ìƒ ì—¬ê¸° ìˆì–´ìš”.",
      "ë„ˆë¬´ ì˜í•˜ê³  ìˆì–´ìš”. ì˜¤ëŠ˜ ìì‹ ì„ ë„ˆë¬´ ëª°ì•„ë¶™ì´ì§€ ë§ì•„ìš”."
    ];

    emotionBtn.addEventListener("click", () => {
      if (!emotionInput.value.trim()) return;
      state.emotionLogs++;
      saveState();
      const msg = emotionMsgs[Math.floor(Math.random() * emotionMsgs.length)];
      emotionResponse.textContent = msg;
      emotionInput.value = "";
      updateReport();
    });

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ íƒ­ ì „í™˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const mainTabs = document.querySelectorAll(".tab-btn");
    const sections = {
      home: document.getElementById("section-home"),
      mission: document.getElementById("section-mission"),
      rival: document.getElementById("section-rival"),
      social: document.getElementById("section-social"),
      report: document.getElementById("section-report")
    };
    const mainTitle = document.getElementById("main-title");
    const mainSub = document.getElementById("main-sub");

    const tabText = {
      home: ["ì˜¤ëŠ˜ì˜ ì‘ì€ ë£¨í‹´", "ì‘ì€ í–‰ë™ì„ í•˜ë©´ XPê°€ ìŒ“ì…ë‹ˆë‹¤."],
      mission: ["Social Mission", "ë‚œì´ë„ì— ë§ëŠ” ì‚¬íšŒì  ë¯¸ì…˜ìœ¼ë¡œ ì ê·¹ì„±ì„ í‚¤ì›Œìš”."],
      rival: ["Rival Battle", "AI Rivalê³¼ ì ìˆ˜ ê²½ìŸì„ í•˜ë©° ì¬ë¯¸ìˆê²Œ ë™ê¸°ë¶€ì—¬ë¥¼ í•©ë‹ˆë‹¤."],
      social: ["Social Connect", "AI ëŒ€í™”ì™€ ìµëª… ì—°ê²°ë¡œ ê³ ë¦½ê°ì„ ì¤„ì…ë‹ˆë‹¤."],
      report: ["ë¦¬í¬íŠ¸", "ì§€ê¸ˆê¹Œì§€ì˜ í–‰ë™ ë°ì´í„°ë¥¼ ìš”ì•½í•´ì„œ ë³´ì—¬ì¤ë‹ˆë‹¤."]
    };

    mainTabs.forEach(btn => {
      btn.addEventListener("click", () => {
        mainTabs.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const tab = btn.dataset.tab;
        Object.keys(sections).forEach(key => {
          sections[key].classList.toggle("active", key === tab);
        });

        mainTitle.textContent = tabText[tab][0];
        mainSub.textContent = tabText[tab][1];

        if (tab === "rival") recalcRival();
        if (tab === "report") updateReport();
      });
    });

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Social Mission â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const diffButtons = document.querySelectorAll(".difficulty-btn");
    const missionTextEl = document.getElementById("social-mission-text");
    const missionXpLabel = document.getElementById("social-mission-xp");
    const missionMsgEl = document.getElementById("social-mission-msg");

    const diffMissions = {
      easy: [
        "ì˜¤ëŠ˜ ê¸°ë¶„ì„ AI ì±„íŒ…ì— í•œ ì¤„ë§Œ ë‚¨ê¸°ê¸°",
        "ë¬¼ í•œ ì»µ ë§ˆì‹œê³ , 'ë§ˆì…¨ë‹¤!'ë¼ê³  ìŠ¤ìŠ¤ë¡œì—ê²Œ ë§í•´ë³´ê¸°",
        "ì°½ë¬¸ ì—´ê³  10ì´ˆ ë™ì•ˆ ê¹Šê²Œ ìˆ¨ ë“¤ì´ë§ˆì‹œê¸°",
        "Social íƒ­ì˜ AIì—ê²Œ ê·¸ëƒ¥ ì´ëª¨ì§€ í•˜ë‚˜ë§Œ ë³´ë‚´ê¸° ğŸ˜Š",
        "ì˜¤ëŠ˜ ìŠ¤ìŠ¤ë¡œ ì¹­ì°¬ í•œ ë§ˆë”” ì†ìœ¼ë¡œ í•´ë³´ê¸°"
      ],
      medium: [
        "1ë¶„ ë™ì•ˆ ì§‘ ì•ˆì„ ì²œì²œíˆ ê±¸ì–´ ë‹¤ë‹ˆë©´ì„œ ëª¸ í’€ì–´ë³´ê¸°",
        "ë°–ì— ë‚˜ê°€ì„œ í•˜ëŠ˜ í•œ ë²ˆ ì˜¬ë ¤ë‹¤ë³´ê³  ëŒì•„ì˜¤ê¸°",
        "ì˜¤ëŠ˜ í•  ì¼ 1ê°œë¥¼ ì ê³ , Social íƒ­ AIì—ê²Œ ê³µìœ í•˜ê¸°",
        "ê³¼ì œë‚˜ ê³µë¶€ ê´€ë ¨ ì§ˆë¬¸ 1ê°œë¥¼ ë– ì˜¬ë¦¬ê³  ë©”ëª¨í•´ë‘ê¸°",
        "ë°© í•œ êµ¬ì„ë§Œ 1ë¶„ ë™ì•ˆ ì •ë¦¬í•´ë³´ê¸°"
      ],
      hard: [
        "ì¹œêµ¬ë‚˜ ê°€ì¡±ì—ê²Œ 'ì˜ ì§€ë‚´?' ë©”ì‹œì§€ ë³´ë‚´ê¸°",
        "í•™êµ/ê³¼/ê³µë¶€ ê´€ë ¨í•´ì„œ ê¶ê¸ˆí•œ ì  í•˜ë‚˜ë¥¼ ì •ë¦¬í•´ì„œ ë©”ëª¨í•˜ê³  ë‚˜ì¤‘ì— ë¬¼ì–´ë³´ê¸°",
        "ì˜¤ëŠ˜ ê³µë¶€ ê³„íšì„ ê°„ë‹¨íˆ ì ê³  Social íƒ­ AIì—ê²Œ ê³µìœ í•˜ê¸°",
        "ì§‘ ê·¼ì²˜ë¥¼ 5ë¶„ë§Œ ì‚°ì±…í•˜ë©° ì˜¤ëŠ˜ ìˆì—ˆë˜ ì¼ì„ ë– ì˜¬ë ¤ë³´ê¸°",
        "ì˜¤ëŠ˜ ê°ì‚¬í•œ ì¼ 1ê°€ì§€ë¥¼ ë– ì˜¬ë ¤ì„œ ë©”ëª¨ì¥ì— ì ê¸°"
      ]
    };

    const diffXp = {
      easy: 20,
      medium: 30,
      hard: 40
    };

    let currentDiff = "easy";
    let currentMission = "";

    function pickMission() {
      const pool = diffMissions[currentDiff];
      currentMission = pool[Math.floor(Math.random() * pool.length)];
      missionTextEl.textContent = currentMission;
      missionXpLabel.textContent = `ì™„ë£Œ ì‹œ +${diffXp[currentDiff]} XP`;
      missionMsgEl.textContent = "";
    }

    diffButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        diffButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentDiff = btn.dataset.diff;
        pickMission();
      });
    });

    document.getElementById("social-mission-refresh")
      .addEventListener("click", pickMission);

    document.getElementById("social-mission-complete")
      .addEventListener("click", () => {
        if (!currentMission) return;
        state.xp += diffXp[currentDiff];
        state.socialMissions++;
        saveState();
        updateXPUI();
        updateReport();
        missionMsgEl.textContent = "ì˜ í–ˆì–´ìš”! ì˜¤ëŠ˜ë„ ì‘ì€ ì—°ê²° í•œ ê±¸ìŒ ì„±ê³µ ğŸ‘";
      });

    pickMission();

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Rival â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const rivalNames = ["GPT", "Gemini", "Claude", "Grok"];
    function recalcRival() {
      const myScore =
        state.todayGoals * 20 +
        state.emotionLogs * 5 +
        state.aiChats * 3 +
        state.socialMissions * 15;

      const rivalScore = Math.floor(Math.random() * 70) + 20;
      const name = rivalNames[Math.floor(Math.random() * rivalNames.length)];

      document.getElementById("my-score").textContent = myScore;
      document.getElementById("rival-score").textContent = rivalScore;
      document.getElementById("rival-name").textContent = `AI Rival (${name})`;

      const resultEl = document.getElementById("rival-result");
      if (myScore > rivalScore) {
        resultEl.textContent = "ğŸ‰ ì˜¤ëŠ˜ì€ ë‹¹ì‹ ì˜ ìŠ¹ë¦¬! ì´ íë¦„ì„ ì´ì–´ê°€ ë³¼ê¹Œìš”?";
      } else if (myScore === rivalScore) {
        resultEl.textContent = "ğŸ¤ ì˜¤ëŠ˜ì€ ë™ì ì´ì—ìš”. ë‚´ì¼ì€ ë¯¸ì…˜ í•˜ë‚˜ë§Œ ë”!";
      } else {
        resultEl.textContent = "ğŸ”¥ Rivalì´ ì•ì„œê°€ìš”! ì§€ê¸ˆì´ë¼ë„ Social Mission í•˜ë‚˜ ë„ì „?";
      }

      updateReport();
    }
    document.getElementById("rival-recalc").addEventListener("click", recalcRival);

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Social â€“ AI Chat â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const chatWindow = document.getElementById("chat-window");
    const chatInput = document.getElementById("chat-input");
    const chatSend = document.getElementById("chat-send");

    const aiReplies = [
      "ê·¸ëŸ´ ìˆ˜ ìˆì–´ìš”. ì˜¤ëŠ˜ ì—¬ê¸°ê¹Œì§€ ì˜¨ ê²ƒë§Œ í•´ë„ ì˜í•˜ê³  ìˆì–´ìš”.",
      "ì˜¤ëŠ˜ ë§ì´ í˜ë“¤ì—ˆê² ë„¤ìš”. ê·¸ë˜ë„ ì €ë‘ ì´ì•¼ê¸°í•´ì¤˜ì„œ ê³ ë§ˆì›Œìš”.",
      "ì¡°ê¸ˆì”© ë‚˜ì•„ì§ˆ ê±°ì˜ˆìš”. ë„ˆë¬´ ì¡°ê¸‰í•´í•˜ì§€ ì•Šì•„ë„ ê´œì°®ì•„ìš”.",
      "ì´ì•¼ê¸°ë¥¼ êº¼ë‚¸ ê²ƒ ìì²´ê°€ í° ìš©ê¸°ì˜ˆìš”."
    ];

    function appendChat(text, who) {
      const bubble = document.createElement("div");
      bubble.className = "chat-bubble " + (who === "user" ? "chat-user" : "chat-ai");
      bubble.textContent = text;
      chatWindow.appendChild(bubble);
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    chatSend.addEventListener("click", () => {
      const txt = chatInput.value.trim();
      if (!txt) return;
      appendChat(txt, "user");
      chatInput.value = "";
      state.aiChats++;
      saveState();
      updateReport();

      const reply = aiReplies[Math.floor(Math.random() * aiReplies.length)];
      setTimeout(() => appendChat(reply, "ai"), 300);
    });

    chatInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") chatSend.click();
    });

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Social ë‚´ë¶€ íƒ­ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const socialTabBtns = document.querySelectorAll(".social-sub-btn");
    const socialBoxes = {
      "ai-chat": document.getElementById("social-ai-chat"),
      anon: document.getElementById("social-anon"),
      voice: document.getElementById("social-voice")
    };

    socialTabBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        socialTabBtns.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const key = btn.dataset.social;
        Object.keys(socialBoxes).forEach(k => {
          socialBoxes[k].style.display = (k === key) ? "block" : "none";
        });
      });
    });

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë¦¬í¬íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function updateReport() {
      document.getElementById("report-goals").textContent = state.totalGoals;
      document.getElementById("report-emotions").textContent = state.emotionLogs;
      document.getElementById("report-chats").textContent = state.aiChats;
      document.getElementById("report-social-missions").textContent = state.socialMissions;

      const score =
        state.todayGoals * 20 +
        state.emotionLogs * 5 +
        state.aiChats * 3 +
        state.socialMissions * 15;

      document.getElementById("report-today").textContent = score + " ì ";
    }
    updateReport();
  </script>
</div>
</body>
</html>
