// components/useRewardSystem.js

import { useState, useEffect } from 'react';

/**
 * @function useRewardSystem
 * @description ê²½í—˜ì¹˜(XP)ì™€ ë ˆë²¨ ì‹œìŠ¤í…œì„ ê´€ë¦¬í•˜ëŠ” ì»¤ìŠ¤í…€ í›…
 * * ë ˆë²¨ ê³µì‹: Math.floor(XP / 100) + 1
 */
export function useRewardSystem() {
  // TODO: ì‹¤ì œ ì•±ì—ì„œëŠ” ì´ ì´ˆê¸°ê°’ì„ localStorage ë˜ëŠ” DBì—ì„œ ë¶ˆëŸ¬ì™€ì•¼ í•©ë‹ˆë‹¤.
  const [xp, setXp] = useState(0); 
  const [level, setLevel] = useState(1);

  // XPê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ë ˆë²¨ì„ ê³„ì‚°í•˜ê³  ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
  useEffect(() => {
    // 100 XPë‹¹ 1 ë ˆë²¨ ìƒìŠ¹ (100xp = level 2)
    const newLevel = Math.floor(xp / 100) + 1;
    if (newLevel !== level) {
      setLevel(newLevel);
      console.log(`ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ë ˆë²¨ ${newLevel}ë¡œ ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤!`);
    }
  }, [xp, level]);

  // ì™¸ë¶€ì—ì„œ XPë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜
  const addXp = (amount) => {
    // 'amount'ëŠ” ëª©í‘œ ì™„ë£Œ ì‹œ ì§€ê¸‰í•  XP (ì˜ˆ: ì‘ì€ ëª©í‘œ ì™„ë£Œ ì‹œ 10 XP)
    setXp(prev => prev + amount);
    // TODO: DBì— xp ê°’ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ í˜¸ì¶œ í•„ìš”
  };

  return { xp, level, addXp };
}
// components/MicroGoalSection.js

import React, { useState } from 'react';

// TODO: ì´ ëª©í‘œ ëª©ë¡ì€ DBì—ì„œ ë¶ˆëŸ¬ì™€ì•¼ í•©ë‹ˆë‹¤. (1ë²ˆ ê¸°ëŠ¥)
const baseGoals = [
  { id: 1, title: "ë¬¼ í•œ ì»µ ë§ˆì‹œê¸°", xp: 10, isDone: false },
  { id: 2, title: "ì˜¤ëŠ˜ 20ë¶„ ê³µë¶€í•˜ê¸°", xp: 30, isDone: false },
  { id: 3, title: "ë‚´ì¼ í•  ì¼ 3ê°€ì§€ ì •ë¦¬í•˜ê¸°", xp: 20, isDone: false },
];

export default function MicroGoalSection({ addXp }) {
  const [goals, setGoals] = useState(baseGoals);

  const handleGoalCompletion = (goalId) => {
    setGoals(prevGoals => prevGoals.map(goal => {
      if (goal.id === goalId && !goal.isDone) {
        // ëª©í‘œ ì™„ë£Œ ì²˜ë¦¬
        const newGoal = { ...goal, isDone: true };
        
        // XP ë³´ìƒ ì§€ê¸‰
        addXp(goal.xp); 
        console.log(`+${goal.xp} XP íšë“!`);
        
        return newGoal;
      }
      return goal;
    }));
  };

  return (
    <section className="micro-goal-section">
      <h3>âœ¨ ì˜¤ëŠ˜ì˜ ì‘ì€ ëª©í‘œ</h3>
      <div className="goal-list">
        {goals.map(goal => (
          <div key={goal.id} className={`goal-item ${goal.isDone ? 'completed' : ''}`}>
            <input
              type="checkbox"
              checked={goal.isDone}
              onChange={() => handleGoalCompletion(goal.id)}
              disabled={goal.isDone}
            />
            <span className={goal.isDone ? 'done-text' : ''}>{goal.title}</span>
            {goal.isDone && <span style={{ marginLeft: '10px', color: 'green' }}>âœ… ì™„ë£Œ</span>}
          </div>
        ))}
      </div>
    </section>
  );
}
// pages/index.js

import Head from 'next/head';
import { useRewardSystem } from '../components/useRewardSystem';
import MicroGoalSection from '../components/MicroGoalSection';
import styles from '../styles/Home.module.css'; // Next.js ê¸°ë³¸ CSS

export default function HomePage() {
  const { xp, level, addXp } = useRewardSystem();

  return (
    <div className={styles.container}>
      <Head>
        <title>ğŸŒ± ì‘ì€ ì„±ê³µ - ë™ê¸° ë¶€ì—¬ ì•±</title>
      </Head>

      <main className={styles.main}>
        <h1>ğŸš€ ë™ê¸° ë¶€ì—¬ ì‹œìŠ¤í…œ</h1>
        
        {/* ì‚¬ìš©ì ë ˆë²¨ ë° XP í‘œì‹œ */}
        <div className={styles.rewardStatus}>
          <p>í˜„ì¬ ë ˆë²¨: ğŸ‘‘ **{level}**</p>
          <p>ê²½í—˜ì¹˜(XP): **{xp}** / 100</p>
          <div className="progress-bar-container">
            {/*  */}
            <div 
              className="progress-bar" 
              style={{ width: `${(xp % 100)}%` }}
            ></div>
          </div>
        </div>

        {/* 1. ì˜¤ëŠ˜ì˜ ì‘ì€ ëª©í‘œ ì„¹ì…˜ */}
        <MicroGoalSection addXp={addXp} />
        
        {/* TODO: 2, 3, 4ë²ˆ ê¸°ëŠ¥ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ì—¬ê¸°ì— ì¶”ê°€í•©ë‹ˆë‹¤. */}

      </main>

      <footer className={styles.footer}>
        <p>GitHub Code & Vercel Deployment Project</p>
      </footer>
    </div>
  );
}

// ì´ íŒŒì¼ì€ Next.jsê°€ ìë™ìœ¼ë¡œ ë¼ìš°íŒ…í•˜ì—¬ '/' ê²½ë¡œì˜ ì•± í™”ë©´ì„ ë§Œë“­ë‹ˆë‹¤.
